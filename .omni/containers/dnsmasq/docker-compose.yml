name: dnsmasq
services:
    dnsmasq:
        container_name: dnsmasq
        cap_add:
            - NET_ADMIN
        network_mode: host
        image: quay.io/poseidon/dnsmasq:v0.5.0
        command: -d -q
            --dhcp-range=10.1.1.1,proxy,255.255.255.0
            --enable-tftp
            --tftp-root=/var/lib/tftpboot
            --dhcp-userclass=set:ipxe,iPXE
            --pxe-service=tag:#ipxe,x86PC,"PXE chainload to iPXE",undionly.kpxe
            --pxe-service=tag:ipxe,x86PC,"iPXE",http://10.1.1.11/boot.ipxe
            --pxe-service=tag:#ipxe,X86-64_EFI,"PXE chainload to iPXE UEFI",ipxe.efi
            --pxe-service=tag:ipxe,X86-64_EFI,"iPXE UEFI",http://10.1.1.11/boot.ipxe
            --log-queries
            --log-dhcp
